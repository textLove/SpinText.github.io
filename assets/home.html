<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Home - Text Love</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="description" content="Free Bootstrap 4 Template by uicookies.com">
    <meta name="keywords"
        content="Free website templates, Free bootstrap themes, Free template, Free bootstrap, Free website template">

    <link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,400i,600|Montserrat:200,300,400"
        rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/loadingio/ldbutton@v1.0.1/dist/ldbtn.min.css" />
    <link rel="stylesheet" href="./css/bootstrap/bootstrap.css">
    <link rel="stylesheet" href="./css/loading.min.css">
    <link rel="stylesheet" href="./fonts/ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="./fonts/law-icons/font/flaticon.css">

    <link rel="stylesheet" href="./fonts/fontawesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/slick.css">
    <link rel="stylesheet" href="./css/slick-theme.css">

    <link rel="stylesheet" href="./css/helpers.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/landing-2.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
    <!-- update the version number as needed -->
    <script defer src="/__/firebase/7.8.1/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/7.8.1/firebase-auth.js"></script>
    <script defer src="/__/firebase/7.8.1/firebase-database.js"></script>
    <script defer src="/__/firebase/7.8.1/firebase-messaging.js"></script>
    <script defer src="/__/firebase/7.8.1/firebase-storage.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>
    <style>
        div#imageContainer {
            height: 330px;
        }

        #switchWrapper {
            position: absolute;
            top: 75px;
            left: calc(50% - 100px);
            background: white;
            padding: 0 50px;
            border-radius: 5px;
        }

        div#imageContainer img {
            width: 50%;
            height: 50%;
        }

        .doButton {
            position: absolute;
            bottom: 40px;
            right: calc(50% - 40px);
        }

        .doButton button {
            background: none;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>

<body data-spy="scroll" data-target="#pb-navbar" data-offset="200">

    <nav class="navbar navbar-expand-lg navbar-dark pb_navbar pb_scrolled-light" id="pb-navbar">
        <div class="container">
            <a class="navbar-brand" href="/index.html">Vission 3</a>
            <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse"
                data-target="#probootstrap-navbar" aria-controls="probootstrap-navbar" aria-expanded="false"
                aria-label="Toggle navigation">
                <span><i class="ion-navicon"></i></span>
            </button>
            <div class="collapse navbar-collapse" id="probootstrap-navbar">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item"><a class="nav-link" href="/home.html">Stories</a></li>
                    <li class="nav-item"><a class="nav-link" href="/reviews.html">Reviews</a></li>
                    <li id="logout" class="nav-item cta-btn ml-xl-2 ml-lg-2 ml-md-0 ml-sm-0 ml-0"><a class="nav-link"
                            href="#" target="_blank"><span class="pb_rounded-4 px-4">
                                Logout
                            </span></a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- END nav -->

    <section class="pb_xl_py_cover overflow-hidden pb_slant-light pb_gradient_v1 cover-bg-opacity-8"
        style="background-image: url(./images/1900x1200_img_5.jpg);height: 100vh;">
        <div class="container">
            <div id="switchWrapper" class="custom-control custom-switch">
                <input type="checkbox" checked class="custom-control-input" id="customSwitch1">
                <label class="custom-control-label" for="customSwitch1">Input URL</label>
            </div>
            <div class="row align-items-center justify-content-center">
                <div id="pan2" class="col-md-5">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon1">URL*</span>
                        </div>
                        <input type="text" id="textArea3"
                            value="https://www.kidsgen.com/stories/bedtime_stories/a_wise_parrot.htm"
                            class="form-control" aria-label="url" aria-describedby="basic-addon1">
                    </div>
                </div>
                <div id="pan1" class="col-md-5">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon1">Title*</span>
                        </div>
                        <input type="text" id="textArea1" class="form-control" aria-label="title"
                            aria-describedby="basic-addon1">
                    </div>
                    <div class="form-group">
                        <label for="textArea2">Text*</label>
                        <textarea class="form-control" id="textArea2" rows="13"></textarea>
                    </div>
                </div>
                <div class="col-md-1"></div>
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="textArea2">Output</label>
                        <div id="imageContainer"></div>
                    </div>
                </div>
            </div>
            <div class="doButton">
                <button id="convert" type="button" class="btn btn-primary">Convert</button>
            </div>
        </div>
    </section>
    <!-- END section -->

    <!-- loader -->
    <div id="pb_loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
            <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
            <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
                stroke="#1d82ff" /></svg></div>


    <script src="./js/jquery.min.js"></script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="./js/slick.min.js"></script>
    <script src="./js/jquery.waypoints.min.js"></script>
    <script src="./js/jquery.easing.1.3.js"></script>
    <script src="./js/main.js"></script>



    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // async function postData(url = '', data = {}) {
            //     const response = await fetch(url, {
            //         method: 'POST',
            //         mode: 'cors',
            //         credentials: 'same-origin',
            //         headers: {
            //             'Content-Type': 'application/json'
            //         },
            //         body: JSON.stringify(data)
            //     });
            //     return response.json();
            // }
            $('#logout').click(signOut);
            $('#pan1').hide();
            var userData;
            function signOut() {
                firebase.auth().signOut().then(function () {
                    window.location = "/index.html"
                }, function (error) {
                    console.error(error)
                });
            }
            $('#customSwitch1').click(() => {
                if ($('#customSwitch1').is(":checked")) {
                    $('#pan1').hide();
                    $('#pan2').show();
                } else {
                    $('#pan2').hide();
                    $('#pan1').show();
                }
            })
            $('#convert').click(function () {
                $('#imageContainer').empty()
                $('#convert').text('Loading....').attr("disabled", true);
                var DATA = $('#customSwitch1').is(":checked") ? {
                    url: $('#textArea3').val().trim()
                } : {
                        title: $('#textArea1').val().trim(),
                        content: $('#textArea2').val().trim()
                    }
                if (DATA && userData) {
                    axios.post('https://35.193.179.215:443/spintext', DATA)
                        .then((apiResponse) => {
                            $('#convert').text('Convert').attr("disabled", false);
                            const apiData = apiResponse.data
                            apiData = apiData.reverse();
                            apiData.forEach((img) =>
                                $('#imageContainer').append('<img src="' + img + '"/>')
                            )
                        })
                        .catch(function (error) {
                            console.log("#ERROR", error.data);
                        });
                }
            });
            firebase.auth().onAuthStateChanged(function (user) {
                if (user) {
                    firebase.database().ref('users/' + user.uid)
                        .once('value', snapshot => {
                            userData = snapshot.val();
                            userData.uid = user.uid;
                        });
                } else {
                    signOut()
                }
            });
        });
    </script>
</body>

</html>