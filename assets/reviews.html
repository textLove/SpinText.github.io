<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Reviews - Text Love</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="description" content="Free Bootstrap 4 Template by uicookies.com">
    <meta name="keywords"
        content="Free website templates, Free bootstrap themes, Free template, Free bootstrap, Free website template">

    <link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,400i,600|Montserrat:200,300,400"
        rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/loadingio/ldbutton@v1.0.1/dist/ldbtn.min.css" />
    <link rel="stylesheet" href="./css/bootstrap/bootstrap.css">
    <link rel="stylesheet" href="./css/loading.min.css">
    <link rel="stylesheet" href="./fonts/ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="./fonts/law-icons/font/flaticon.css">

    <link rel="stylesheet" href="./fonts/fontawesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/slick.css">
    <link rel="stylesheet" href="./css/slick-theme.css">

    <link rel="stylesheet" href="./css/helpers.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/landing-2.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
    <!-- update the version number as needed -->
    <script defer src="/__/firebase/7.8.1/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/7.8.1/firebase-auth.js"></script>
    <script defer src="/__/firebase/7.8.1/firebase-database.js"></script>
    <script defer src="/__/firebase/7.8.1/firebase-messaging.js"></script>
    <script defer src="/__/firebase/7.8.1/firebase-storage.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>
    <script src="./js/jquery.min.js"></script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="./js/slick.min.js"></script>
    <script src="./js/jquery.waypoints.min.js"></script>
    <script src="./js/jquery.easing.1.3.js"></script>
    <style>
        div#imageContainer {
            height: 330px;
        }

        input#textArea3 {
            width: 100%;
        }

        nav {
            background: #4f7ddb;
        }

        .imgMainBOx>div {
            display: flex;
            justify-content: space-between;
        }

        div#msgBox {
            width: 60%;
            margin-left: 20px;
            width: 60%;
            margin-left: 20px;
            height: 400px;
            overflow: auto;
            padding: 0px 1px;
        }

        div#msgBox p {
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
            background: #ffffff;
            padding: 5px 10px;
            font-size: 14px;
            border-radius: 5px;
        }

        #switchWrapper {
            position: absolute;
            top: 75px;
            left: calc(50% - 250px);
            width: 500px;
            border-radius: 5px;
        }

        div#imageContainer img {
            width: 50%;
            height: 50%;
        }

        div#bar {
            display: flex;
            margin-bottom: 10px;
            width: 400px;

        }

        div#bar img {
            width: 20px;
            height: 20px;
        }

        div#bar>div {
            display: flex;
        }

        div#bar>div p {
            padding: 0;
            margin: 0 5px;
        }

        body {
            background-color: #e2e1e0;
        }

        .imgMainBOx {
            position: relative;
            top: 180px;
            width: 800px;
            margin: 0 auto;
        }

        mark.marked {
            background: #070000d6;
            color: #ffffff;
            font-weight: 400;
            border-radius: 5px;
            padding: 3px 5px;
        }

        .click {
            background-color: #ffefbf !important;
        }

        .doButton {
            margin: 10px auto;
            width: 85px;
        }

        div#reviewBox {
            margin-bottom: 20px;
            overflow: auto;
            display: grid;
            grid-gap: 5px;
            width: 640px;
            grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
            grid-template-rows: repeat(2, 110px);
        }

        div#reviewBox>div>div {
            font-size: 16px;
            text-align: center;
            font-weight: 600;
        }

        div#reviewBox>div p {
            cursor: pointer;
        }

        div#reviewBox>div {
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100px;
            cursor: pointer;
            justify-content: center;
            border-radius: 5px;
            background: #FFFFFF;
        }

        .positive {
            border: 3px solid #71E277 !important;
        }

        .negative {
            border: 3px solid #F6BFB9 !important;
        }

        div#reviewBox p {
            margin: 0;
            padding: 0;
            font-size: 14px;
        }

        .doButton button {
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>

<body data-spy="scroll" data-target="#pb-navbar" style="overflow: unset;" data-offset="200">

    <nav class="navbar navbar-expand-lg navbar-dark pb_navbar pb_scrolled-light" id="pb-navbar">
        <div class="container">
            <a class="navbar-brand" href="/index.html">Spin Text</a>
            <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse"
                data-target="#probootstrap-navbar" aria-controls="probootstrap-navbar" aria-expanded="false"
                aria-label="Toggle navigation">
                <span><i class="ion-navicon"></i></span>
            </button>
            <div class="collapse navbar-collapse" id="probootstrap-navbar">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item"><a class="nav-link" href="/home.html">Stories</a></li>
                    <li class="nav-item"><a class="nav-link" href="/reviews.html">Reviews</a></li>
                    <li id="logout" class="nav-item cta-btn ml-xl-2 ml-lg-2 ml-md-0 ml-sm-0 ml-0"><a class="nav-link"
                            href="#" target="_blank"><span class="pb_rounded-4 px-4">
                                Logout
                            </span></a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- END nav -->

    <section class="sec">
        <div class="container">
            <div id="switchWrapper" class="custom-control custom-switch">
                <input type="text" id="textArea3" placeholder="CSV path"
                    value="https://35.193.179.215/datasets/reviews/huawei_p9_plus_(p9+)_vie-l29_64gb_5.5_inch_12_mp_dual_sim_lte_factory_unlocked_-_international_stock_no_warranty_(quartz_grey).csv"
                    aria-label="url" aria-describedby="basic-addon1" />
                <div class="doButton">
                    <button id="convert" type="button" class="btn btn-primary">Convert</button>
                </div>
            </div>
            <div class="imgMainBOx">
                <label for="textArea2">Output</label>
                <div id="bar"></div>
                <div>
                    <div id="reviewBox">

                    </div>
                    <div id="msgBox">

                    </div>
                </div>
            </div>

        </div>
    </section>
    <!-- END section -->

    <!-- loader -->
    <div id="pb_loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
            <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
            <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
                stroke="#1d82ff" /></svg></div>



    <script src="./js/main.js"></script>
    <script src="./js/mark.min.js"></script>



    <script>
        document.addEventListener('DOMContentLoaded', function () {
            $('#logout').click(signOut);
            $('#pan1').hide();
            var userData;
            function signOut() {
                firebase.auth().signOut().then(function () {
                    window.location = "/index.html"
                }, function (error) {
                    console.error(error)
                });
            }
            function getReviewDetail(e) {
                $('div#reviewBox>div').removeClass('click')
                var el = $(e.currentTarget);
                el.addClass('click');
                debugger
                var ID = el.data('id');
                var keyPhrase = el.data('keyPhrase');
                var url = el.data('url');
                var similarPhrases = el.data('similarPhrases');
                var SYN = {}
                similarPhrases.forEach(x => SYN[x] = keyPhrase);
                if (ID) {
                    $('#msgBox').empty();
                    axios.post('https://35.193.179.215:443/reviews', {
                        ids: ID, url
                    }).then((apiResponse) => {
                        const apiData = apiResponse.data
                        apiData.forEach((dt) =>
                            $('#msgBox').append(`<p>${dt}</p>`)
                        )
                        $('#msgBox').mark(keyPhrase, {
                            className: 'marked',
                            synonyms: SYN,
                            separateWordSearch: false
                        })
                    }).catch(function (error) {
                        console.log("#ERROR", error);
                    });
                }
            }
            $('div#reviewBox>div p').on('click', (e) => {

            })
            $('#customSwitch1').click(() => {
                if ($('#customSwitch1').is(":checked")) {
                    $('#pan1').hide();
                    $('#pan2').show();
                } else {
                    $('#pan2').hide();
                    $('#pan1').show();
                }
            })
            function getBar(apiData) {
                $('#bar').empty();
                $('#bar').append(`
                           <div>Total Reviews: ${apiData.totalReviews}</div>
                           <div><p>&#128578;</p> ${apiData.positvieReviwes}</div>
                           <div><p>&#128577;</p> ${apiData.negativeReviews}</div>
                           <div><p>&#128528;</p> ${apiData.neutralReviwes}</div>
                            `)
            }
            $('#convert').click(function () {
                $('#bar').empty();
                $('#msgBox').empty()
                $('#convert').text('Loading....').attr("disabled", true);
                $('#reviewBox').empty();
                var DATA = $('#textArea3').val().trim();
                if (DATA && userData) {
                    debugger
                    axios.post('https://35.193.179.215:443/reviewsummary', { url: DATA })
                        .then((apiResponse) => {
                            $('#convert').text('Convert').attr("disabled", false);
                            const apiData = apiResponse.data
                            debugger
                            getBar(apiData);
                            var DATA1 = JSON.parse(apiData.reviewSummary);
                            DATA1.forEach((dt) => {
                                var tmpl = $(`<div class="${dt.sentiment}"><div>${dt.keyPhrase}</div><p>Reviews(${dt.reviewIds.length})</p></div>`);
                                tmpl.data('id', dt.reviewIds);
                                tmpl.data('keyPhrase', dt.keyPhrase);
                                tmpl.data('url', DATA);
                                tmpl.data('similarPhrases', apiData.similarPhrases[dt.keyPhrase] || []);
                                tmpl.click(getReviewDetail);
                                $('#reviewBox').append(tmpl);
                            })
                        })
                        .catch(function (error) {
                            console.log("#ERROR", error);
                        });
                }
            });
            firebase.auth().onAuthStateChanged(function (user) {
                if (user) {
                    firebase.database().ref('users/' + user.uid)
                        .once('value', snapshot => {
                            userData = snapshot.val();
                            userData.uid = user.uid;
                        });
                } else {
                    signOut()
                }
            });
            const DEF_DATA = { "negativeReviews": 5, "neutralReviwes": 0, "otherReviews": 0, "positvieReviwes": 22, "reviewSummary": "[{\"keyPhrase\": \"dual sim features\", \"sentiment\": \"positive\", \"relevanceScore\": 0.977635, \"reviewIds\": [203371, 203379, 203389, 203394], \"ctx\": true}, {\"keyPhrase\": \"Battery life\", \"sentiment\": \"positive\", \"relevanceScore\": 0.964974, \"reviewIds\": [203371, 203376, 203378, 203379, 203385, 203389, 203394], \"ctx\": true}, {\"keyPhrase\": \"quality\", \"sentiment\": \"positive\", \"relevanceScore\": 0.669577, \"reviewIds\": [203382, 203394], \"ctx\": true}, {\"keyPhrase\": \"newer version\", \"sentiment\": \"positive\", \"relevanceScore\": 0.580799, \"reviewIds\": [203376, 203394], \"ctx\": true}, {\"keyPhrase\": \"Camera\", \"sentiment\": \"positive\", \"relevanceScore\": 0.578194, \"reviewIds\": [203371, 203373, 203376, 203379, 203389, 203391, 203392, 203394], \"ctx\": true}, {\"keyPhrase\": \"smart controller\", \"sentiment\": \"positive\", \"relevanceScore\": 0.577373, \"reviewIds\": [203378], \"ctx\": true}, {\"keyPhrase\": \"new sim card\", \"sentiment\": \"negative\", \"relevanceScore\": 0.713169, \"reviewIds\": [203372, 203377, 203384, 203390, 203395], \"ctx\": true}, {\"keyPhrase\": \"AT&T networks\", \"sentiment\": \"negative\", \"relevanceScore\": 0.692262, \"reviewIds\": [203372, 203377, 203384, 203390, 203395], \"ctx\": true}, {\"keyPhrase\": \"good amount of effort\", \"sentiment\": \"negative\", \"relevanceScore\": 0.685431, \"reviewIds\": [203372, 203377, 203384, 203390, 203395], \"ctx\": true}, {\"keyPhrase\": \"remote area\", \"sentiment\": \"negative\", \"relevanceScore\": 0.65432, \"reviewIds\": [203384], \"ctx\": true}]", "similarPhrases": { "1hr": ["1hr"], "3G": ["4G label", "P9"], "3G signal": ["4G label"], "3G.": ["4G label", "P9"], "4-wk": ["4-wk"], "4G": ["4G label", "P9"], "4G coverage": ["4G label"], "4G failure": ["4G label"], "4G label": ["4G label"], "4G problem": ["4G label"], "4G sim card": ["new sim card", "4G label"], "4G.": ["4G label", "P9"], "6p": ["6p"], "AT&T": [], "AT&T nano sim card": ["new sim card"], "AT&T networks": ["AT&T networks"], "AT&T store": ["AT&T store"], "Android phones": ["Android phones"], "Battery life": ["Battery life"], "Camera": ["Camera"], "Case": ["Order", "transparent case"], "China": ["China"], "Cons": ["Pros"], "Data": ["Data"], "Google": ["websites"], "Great phone": ["video games", "future"], "Great product": ["Order"], "Group Texting": ["group of recipients"], "HTC smartphones": ["Android phones"], "Huawei": ["Huawei"], "Huawei Ascend P9": ["Huawei", "6p"], "Huawei P8 lite": ["P9"], "Huawei P9": ["P9"], "Huawei p9 plus": ["plus", "6p"], "Huawei phones": ["Huawei"], "Huawei smartphone": ["Android phones", "Huawei"], "Incredible battery life": ["Battery life"], "Iphone 5S": ["Android phones", "apple"], "K-9 Mail": ["P9"], "L29": ["P9"], "LTE": ["LTE"], "LTE functionality": ["LTE", "wifi"], "Mega Mobile": ["AT&T networks", "free Android applications"], "Order": ["Order"], "P8": ["P9"], "P9": ["6p", "P9"], "Perfect Fit": ["Perfect Fit"], "Premium Leather Cover": ["plus"], "Pros": [], "Quality Deals Shopping Center": ["new sim card"], "Samsung": ["Samsung Note"], "Samsung Note": ["Samsung Note"], "Screen": ["video games", "Camera"], "Storage": ["Storage"], "TIMES": ["day", "number"], "Thanks": ["good amount of effort"], "USA for3 days": ["video games"], "Ultra Thin Slim": ["Ultra Thin Slim"], "Update": ["Update"], "Wow Google Map": ["Wow Google Map"], "accessories": ["accessories"], "adaptive outlet": [], "addition": ["good amount of effort", "various APN settings"], "amazon website": [], "apple": ["apple"], "apps": ["Android phones"], "area": ["area"], "authorized seller of the phone": ["new sim card"], "background": [], "battery": ["Battery life"], "best fingerprint reader": ["fingerprint touch"], "best phone": ["video games", "day"], "buildings": [], "bundled apps": ["Android phones"], "camera": ["pictures", "Camera"], "capability": ["capability"], "case": ["good amount of effort", "investigation"], "cell radio bands": ["cell radio bands"], "cellphone": ["Android phones"], "center of a big metro area": ["good amount of effort"], "chance": ["day", "Perfect Fit"], "charge": ["Order"], "contacts": [], "course of action": ["good amount of effort", "side"], "customization": [], "day": ["day"], "days": ["day"], "delivery": [], "double speakers": ["dual sim features"], "double-camera": ["video games", "dual sim features"], "downside": ["downside"], "dual sim features": ["dual sim features"], "easy fix": ["Perfect Fit"], "end of work day": ["video games"], "example": ["good amount of effort"], "faulty sim card": ["new sim card"], "favorite email client": ["new sim card"], "favorite smartphone": ["Android phones"], "fellow shoppers": ["friends"], "filters": ["filters"], "fingerprint touch": ["fingerprint touch"], "first time": ["video games", "Order"], "flexibility": ["patience"], "free Android applications": [], "friends": [], "front of each contact number": ["new sim card"], "front phone numbers": ["video games"], "future": ["future"], "global unlocked phone": ["new sim card", "Data"], "good amount of effort": ["good amount of effort"], "good coverage": ["future", "day"], "good features": ["good amount of effort"], "google apps": ["Android phones", "websites"], "google play": ["video games"], "great camera": ["video games"], "great choice": ["Order"], "great job": ["Order"], "great phone": ["video games"], "great picture": ["future"], "group": ["group of recipients"], "group information": ["new sim card"], "group of recipients": [], "group text capability": ["Order"], "iPhone": ["Android phones", "apple"], "iPhone system": ["Android phones", "system"], "iPhones": ["Android phones"], "image quality.The phone": ["new sim card", "good amount of effort"], "imitation of iPhone interface": ["Android phones"], "individual text message": ["new sim card"], "international format": ["video games", "system"], "international phone": ["day", "cell radio bands"], "international travelers": [], "internet": ["new sim card", "AT&T networks"], "invalid recipient": ["recipient"], "investigation": ["investigation"], "iphone": ["Android phones", "apple"], "issue": ["good amount of effort"], "item": [], "lot": ["good amount of effort"], "lot of freedom": ["future"], "love": ["love"], "market": [], "message": [], "messages": ["message"], "messenger": [], "minutes": ["minutes"], "model": [], "models": ["model"], "month of use": ["video games"], "months": ["day"], "much cheaper P8 lite": ["good amount of effort", "P9"], "music": ["cell radio bands"], "needs": ["good amount of effort"], "new emails": ["new sim card"], "new sim card": ["new sim card"], "newer version": ["newer version"], "number": ["number"], "old P9": ["P9"], "older phones": ["Android phones", "newer version"], "patience": ["patience"], "penny": [], "phone": ["Android phones", "new sim card", "cell radio bands", "AT&T networks", "message"], "phone numbers": ["new sim card"], "phones": ["Android phones", "free Android applications"], "photos": [], "pictures": ["pictures"], "plus": ["plus"], "premium features": ["various APN settings"], "pro photographer": ["pro photographer"], "pro shots": ["video games"], "problems": ["good amount of effort"], "quality": [], "readers": ["readers"], "reason": ["Order", "future"], "recipient": [], "recipients": ["group of recipients"], "recipients' involvements": [], "remote area": [], "reply": [], "ringtones": ["ringtones"], "screen protecter": ["video games", "Camera"], "seller": [], "side": ["side"], "signal strength": ["good amount of effort"], "silicon valley": ["silicon valley"], "sim": ["new sim card"], "sim card": ["new sim card"], "small screen": ["Camera", "cell radio bands"], "smart controller": [], "smart phone": ["new sim card", "message"], "sof mode": [], "solid phone": ["cell radio bands", "Perfect Fit"], "special effects": ["future", "quality"], "stuff": ["Perfect Fit", "love"], "suggestions": ["suggestions"], "system": ["system"], "taiwan": [], "temperature": ["temperature"], "text": ["text"], "thanks": [], "tiny one-story house": ["new sim card"], "transparent case": ["transparent case"], "update": ["update"], "usage": ["usage"], "users": ["readers", "Data"], "various APN settings": ["various APN settings"], "video games": ["video games"], "way": ["good amount of effort", "side", "message"], "weather": ["weather"], "websites": ["websites"], "weeks": ["day", "good amount of effort", "number"], "weeks' usage": ["good amount of effort"], "wife": ["wife"], "wifi": ["wifi"], "wonderful phone": ["Perfect Fit"], "worst phone": ["video games", "day"], "xxx-xxx-xxx": ["xxx-xxx-xxx"] }, "totalReviews": 27 }
            getBar(DEF_DATA);
            JSON.parse(DEF_DATA.reviewSummary).forEach((dt) => {
                var tmpl = $(`<div class="${dt.sentiment}"><div>${dt.keyPhrase}</div><p>Reviews(${dt.reviewIds.length})</p></div>`);
                tmpl.data('id', dt.reviewIds);
                tmpl.data('keyPhrase', dt.keyPhrase);
                tmpl.data('similarPhrases', DEF_DATA.similarPhrases[dt.keyPhrase] || []);
                tmpl.data('url', 'https://35.193.179.215/datasets/reviews/huawei_p9_plus_(p9+)_vie-l29_64gb_5.5_inch_12_mp_dual_sim_lte_factory_unlocked_-_international_stock_no_warranty_(quartz_grey).csv');
                tmpl.click(getReviewDetail);
                $('#reviewBox').append(tmpl);
            });
            $($('#reviewBox').children()[0]).trigger('click');
        });
    </script>
</body>

</html>